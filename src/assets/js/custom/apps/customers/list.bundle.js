"use strict";var KTModalExportCustomers=function(){var t,e,o,n,r,c,l;return{init:function(){t=document.querySelector("#kt_modal_export_customers"),l=new bootstrap.Modal(t),c=document.querySelector("#kt_modal_export_customers_form"),e=c.querySelector("#kt_modal_export_customers_submit"),o=c.querySelector("#kt_modal_export_customers_cancel"),n=t.querySelector("#kt_modal_export_customers_close"),r=FormValidation.formValidation(c,{fields:{date:{validators:{notEmpty:{message:"Date range is required"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row",eleInvalidClass:"",eleValidClass:""})}}),e.addEventListener("click",(function(t){t.preventDefault(),r&&r.validate().then((function(t){console.log("validated!"),"Valid"==t?(e.setAttribute("data-kt-indicator","on"),e.disabled=!0,setTimeout((function(){e.removeAttribute("data-kt-indicator"),Swal.fire({text:"Customer list has been successfully exported!",icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-primary"}}).then((function(t){t.isConfirmed&&(l.hide(),e.disabled=!1)}))}),2e3)):Swal.fire({text:"Sorry, looks like there are some errors detected, please try again.",icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-primary"}})}))})),o.addEventListener("click",(function(t){t.preventDefault(),Swal.fire({text:"Are you sure you would like to cancel?",icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:"Yes, cancel it!",cancelButtonText:"No, return",customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-active-light"}}).then((function(t){t.value?(c.reset(),l.hide()):"cancel"===t.dismiss&&Swal.fire({text:"Your form has not been cancelled!.",icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-primary"}})}))})),n.addEventListener("click",(function(t){t.preventDefault(),Swal.fire({text:"Are you sure you would like to cancel?",icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:"Yes, cancel it!",cancelButtonText:"No, return",customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-active-light"}}).then((function(t){t.value?(c.reset(),l.hide()):"cancel"===t.dismiss&&Swal.fire({text:"Your form has not been cancelled!.",icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-primary"}})}))})),$("#kt_modal_export_customers_datepicker").flatpickr({altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d",mode:"range"})}}}(),KTCustomersListTable=function(){var t,e,o,n=document.querySelector("#kt_table_customers"),r=()=>{n.querySelectorAll('[data-kt-customer-table-filter="delete_row"]').forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();const o=e.target.closest("tr"),n=o.querySelectorAll("td")[1].innerText;Swal.fire({text:"Are you sure you want to delete "+n+"?",icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:"Yes, delete!",cancelButtonText:"No, cancel",customClass:{confirmButton:"btn fw-bold btn-danger",cancelButton:"btn fw-bold btn-active-light-primary"}}).then((function(e){e.value?Swal.fire({text:"You have deleted "+n+"!.",icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn fw-bold btn-primary"}}).then((function(){t.row($(o)).remove().draw()})):"cancel"===e.dismiss&&Swal.fire({text:n+" was not deleted.",icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn fw-bold btn-primary"}})}))}))}))},c=()=>{const e=n.querySelectorAll('[type="checkbox"]'),o=document.querySelector('[data-kt-customer-table-select="delete_selected"]');e.forEach((t=>{t.addEventListener("click",(function(){setTimeout((function(){l()}),50)}))})),o.addEventListener("click",(function(){Swal.fire({text:"Are you sure you want to delete selected customers?",icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:"Yes, delete!",cancelButtonText:"No, cancel",customClass:{confirmButton:"btn fw-bold btn-danger",cancelButton:"btn fw-bold btn-active-light-primary"}}).then((function(o){o.value?Swal.fire({text:"You have deleted all selected customers!.",icon:"success",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn fw-bold btn-primary"}}).then((function(){e.forEach((e=>{e.checked&&t.row($(e.closest("tbody tr"))).remove().draw()}));n.querySelectorAll('[type="checkbox"]')[0].checked=!1})):"cancel"===o.dismiss&&Swal.fire({text:"Selected customers was not deleted.",icon:"error",buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn fw-bold btn-primary"}})}))}))};const l=()=>{const t=document.querySelector('[data-kt-customer-table-toolbar="base"]'),e=document.querySelector('[data-kt-customer-table-toolbar="selected"]'),o=document.querySelector('[data-kt-customer-table-select="selected_count"]'),r=n.querySelectorAll('tbody [type="checkbox"]');let c=!1,l=0;r.forEach((t=>{t.checked&&(c=!0,l++)})),c?(o.innerHTML=l,t.classList.add("d-none"),e.classList.remove("d-none")):(t.classList.remove("d-none"),e.classList.add("d-none"))};return{init:function(){n&&(n.querySelectorAll("tbody tr").forEach((t=>{const e=t.querySelectorAll("td"),o=moment(e[5].innerHTML,"DD MMM YYYY, LT").format();e[5].setAttribute("data-order",o)})),(t=$(n).DataTable({info:!1,order:[],columnDefs:[{orderable:!1,targets:0},{orderable:!1,targets:6}]})).on("draw",(function(){c(),r(),l()})),c(),document.querySelector('[data-kt-customer-table-filter="search"]').addEventListener("keyup",(function(e){t.search(e.target.value).draw()})),e=$('[data-kt-customer-table-filter="month"]'),o=document.querySelectorAll('[data-kt-customer-table-filter="payment_type"] [name="payment_type"]'),document.querySelector('[data-kt-customer-table-filter="filter"]').addEventListener("click",(function(){const n=e.val();let r="";o.forEach((t=>{t.checked&&(r=t.value),"all"===r&&(r="")}));const c=n+" "+r;t.search(c).draw()})),r(),document.querySelector('[data-kt-customer-table-filter="reset"]').addEventListener("click",(function(){e.val(null).trigger("change"),o[0].checked=!0,t.search("").draw()})))}}}();KTUtil.onDOMContentLoaded((function(){KTCustomersListTable.init(),KTModalExportCustomers.init()}));